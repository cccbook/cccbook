### 11.1 貝氏網路的基本原理

貝氏網路（Bayesian Network，簡稱BN），又稱為信念網路，是一種基於概率推理的圖形模型，用於表示變量之間的條件依賴關係。貝氏網路結合了圖論和貝葉斯概率，能夠有效地描述和推理多變量系統中的不確定性。它在人工智慧、機器學習、模式識別、診斷系統等領域得到了廣泛應用。

#### 1. 貝氏網路的結構

貝氏網路是一個有向無環圖（Directed Acyclic Graph，DAG），其中每個節點代表一個隨機變量（可以是觀察到的變量或潛在的變量），而邊則表示變量之間的因果關係。每條邊的方向指示了因果關係的方向。

- **節點（Node）**：每個節點表示一個隨機變量，這些變量可以是可觀測的（例如，天氣狀況、診斷結果）或潛在的（例如，健康狀況、心理狀態）。
  
- **邊（Edge）**：有向邊代表變量之間的因果關係，指示了某個變量是如何依賴於其他變量的。

- **父節點與子節點**：對於每個節點，它的父節點表示該變量的直接原因，而該變量則影響其子節點的概率分佈。

#### 2. 貝氏網路的條件獨立性

貝氏網路的關鍵特性之一是條件獨立性。假設一個變量的條件概率分佈可以通過它的父節點來描述，那麼每個變量在給定其父節點的情況下，與其他不相鄰的變量是條件獨立的。這一特性使得貝氏網路能夠在處理大規模複雜系統時，顯著減少計算的複雜度。

- **局部概率模型**：貝氏網路的每個節點只需要根據其父節點來定義條件概率，這樣就能夠有效地描述系統中變量之間的依賴關係。

- **全概率模型**：整個系統的概率分佈是所有節點條件概率的乘積。對於一個貝氏網路，若變量集合為 \( X = (X_1, X_2, ..., X_n) \)，則其全概率分佈可以寫作：
  
  \[
  P(X_1, X_2, ..., X_n) = \prod_{i=1}^{n} P(X_i | Pa(X_i))
  \]
  其中 \( Pa(X_i) \) 表示變量 \( X_i \) 的父節點集合。

#### 3. 條件概率表（CPT）

在貝氏網路中，每個節點的條件概率由一個條件概率表（Conditional Probability Table，CPT）來表示。CPT列出了在不同父節點條件下，該節點取不同值的概率。對於二元變量（如真/假），CPT簡單地列出每個可能的父節點配置下的概率。

例如，對於一個變量 \( A \)，其父節點集合為 \( Pa(A) = \{B, C\} \)，CPT可能看起來如下：

| \( B \) | \( C \) | \( P(A | B, C) \) |
|---------|---------|-------------------|
| 0       | 0       | 0.1               |
| 0       | 1       | 0.4               |
| 1       | 0       | 0.6               |
| 1       | 1       | 0.9               |

這個表格顯示了在不同的 \( B \) 和 \( C \) 值下，\( A \) 取某個值的條件概率。

#### 4. 貝氏推論

貝氏網路的核心應用之一是進行推理。推理過程的目的是根據已知的證據來更新網絡中其他變量的概率。這種推理可以分為兩種基本形式：

- **前向推理（Forward Inference）**：基於已知的證據，推算網絡中其他變量的可能性。在這種情況下，通常是從一些已知觀察值出發，依照網絡的結構推導出其他變量的概率分佈。

- **後向推理（Backward Inference）**：給定某些目標變量的值，推斷其父節點或先前變量的概率。在醫學診斷中，後向推理尤為重要，因為診斷結果（如病狀）通常是已知的，而需要推斷其可能的原因。

#### 5. 貝氏網路的學習

貝氏網路的學習可以分為兩大類：

- **結構學習**：決定變量之間的依賴關係，即確定網路的拓撲結構。這可以通過最大化觀察數據的似然函數或使用貝葉斯推理進行。

- **參數學習**：在已知結構的情況下，學習每個條件概率表的具體值。這通常通過觀察數據來估計每個節點的條件概率。

#### 6. 貝氏網路的應用

貝氏網路在多個領域具有廣泛的應用，尤其是當問題涉及不確定性和條件依賴性時。常見的應用領域包括：

- **醫學診斷**：貝氏網路可用於根據病人的症狀和檢查結果來推斷可能的病因，幫助醫生進行決策。

- **機器學習與數據挖掘**：在機器學習中，貝氏網路用於建模變量之間的依賴關係，並進行推理與預測。

- **故障診斷**：貝氏網路可用於監控設備運行，根據系統的運行狀態來預測和診斷故障。

- **風險評估與決策支持**：在金融領域，貝氏網路可以用來進行風險分析和決策支持，根據多種不確定因素來預測未來結果。

#### 7. 結語

貝氏網路作為一種強大的概率圖模型，能夠以結構化的方式表示和處理複雜系統中的不確定性。通過結合貝葉斯定理，它提供了一種有效的方式來進行推理和學習。隨著人工智慧和機器學習的發展，貝氏網路的應用場景將持續擴大，尤其在醫療、金融、風險管理等領域中，為決策提供更加精確和可靠的依據。