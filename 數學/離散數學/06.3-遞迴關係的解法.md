### 6.3 遞迴關係的解法

遞迴關係是數學和計算機科學中常見的問題，許多複雜的算法和數學模型都可以用遞迴關係來描述。遞迴關係的解法主要目的是找出數列或函數的閉式解，即求出 \( a_n \) 或 \( f(n) \) 以 \( n \) 的顯式函數表示。根據遞迴關係的類型（齊次或非齊次），解法會有所不同。

### 6.3.1 齊次遞迴關係的解法

對於齊次遞迴關係，其一般形式為：

\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k}
\]

#### 步驟 1：寫出特徵方程

首先，對齊次遞迴關係寫出其特徵方程：

\[
r^k - c_1 r^{k-1} - c_2 r^{k-2} - \cdots - c_k = 0
\]

特徵方程的根 \( r_1, r_2, \dots, r_k \) 將決定解的形式。

#### 步驟 2：解特徵方程

根據特徵方程的解，我們可以得到數列的通解。對於不同類型的根，通解有以下情況：

1. **實根**：如果所有根都是不同的實數 \( r_1, r_2, \dots, r_k \)，則通解為：
   \[
   a_n = A_1 r_1^n + A_2 r_2^n + \dots + A_k r_k^n
   \]
   其中 \( A_1, A_2, \dots, A_k \) 是常數，需通過初始條件確定。

2. **重根**：如果某些根是重根（即有重複的根），例如根 \( r_1 \) 重複 \( m \) 次，則通解為：
   \[
   a_n = (A_1 + A_2 n + A_3 n^2 + \cdots + A_m n^{m-1}) r_1^n
   \]
   其中 \( A_1, A_2, \dots, A_m \) 是常數，需通過初始條件確定。

3. **複數根**：如果根是複數，假設根為 \( r_1 = \alpha + \beta i \) 和 \( r_2 = \alpha - \beta i \)，則通解為：
   \[
   a_n = \alpha^n (A_1 \cos(n\beta) + A_2 \sin(n\beta))
   \]
   其中 \( A_1 \) 和 \( A_2 \) 是常數。

#### 步驟 3：確定常數

利用初始條件，解出常數 \( A_1, A_2, \dots, A_k \)，從而得到遞迴關係的具體解。

#### 例子

考慮以下齊次遞迴關係：

\[
a_n = 3a_{n-1} - 4a_{n-2}, \quad a_0 = 2, \quad a_1 = 4
\]

1. 寫出特徵方程：
   \[
   r^2 - 3r + 4 = 0
   \]
   解這個方程，得到根 \( r_1 = 1 + i \) 和 \( r_2 = 1 - i \)。

2. 寫出通解：
   \[
   a_n = A_1 (1 + i)^n + A_2 (1 - i)^n
   \]
   這是複數形式的解。

3. 利用初始條件 \( a_0 = 2 \) 和 \( a_1 = 4 \) 來確定常數 \( A_1 \) 和 \( A_2 \)。

### 6.3.2 非齊次遞迴關係的解法

對於非齊次遞迴關係，其一般形式為：

\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k} + f(n)
\]

解法通常分為兩個步驟：

#### 步驟 1：解齊次部分

先解對應的齊次遞迴關係，即忽略右側的強迫項 \( f(n) \)，得到齊次解 \( a_n^{(h)} \)。

#### 步驟 2：猜測特解

根據 \( f(n) \) 的形式，猜測一個特解 \( a_n^{(p)} \)。猜測的形式通常依賴於 \( f(n) \) 的類型，例如：

- 若 \( f(n) \) 是常數，則猜測特解為常數。
- 若 \( f(n) \) 是多項式，則猜測特解為多項式。
- 若 \( f(n) \) 是指數函數或包含指數函數，則猜測特解為指數形式。

#### 步驟 3：代入並求解

將猜測的特解代入原遞迴關係，確定其常數。

#### 步驟 4：總解

最終的解是齊次解和特解的總和：
\[
a_n = a_n^{(h)} + a_n^{(p)}
\]
並用初始條件確定常數。

#### 例子

考慮以下非齊次遞迴關係：

\[
a_n = 3a_{n-1} - 4a_{n-2} + 5, \quad a_0 = 2, \quad a_1 = 4
\]

1. 解齊次部分：先解齊次遞迴關係 \( a_n^{(h)} = 3a_{n-1} - 4a_{n-2} \)，得到通解 \( a_n^{(h)} = A_1 r_1^n + A_2 r_2^n \)，其中 \( r_1 = 1 + i \)，\( r_2 = 1 - i \)。

2. 猜測特解：由於右側的強迫項是常數 5，猜測特解為常數 \( a_n^{(p)} = B \)，並代入計算得到 \( B = \frac{5}{2} \)。

3. 結合解：最終解為：
   \[
   a_n = a_n^{(h)} + a_n^{(p)} = A_1 (1 + i)^n + A_2 (1 - i)^n + \frac{5}{2}
   \]
   用初始條件確定常數。

### 6.3.3 結論

解遞迴關係是一個重要的技巧，能幫助我們求解各種數列的閉式解。齊次遞迴關係的解法相對簡單，主要依賴特徵方程。而非齊次遞迴關係則需要先解齊次部分，再對強迫項進行特解的假設與求解。掌握這些解法可以幫助我們處理更為複雜的遞迴問題，並應用於各種數學與計算機科學的實際問題中。