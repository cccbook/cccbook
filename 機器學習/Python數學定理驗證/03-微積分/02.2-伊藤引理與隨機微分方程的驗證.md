### 2.2 **伊藤引理與隨機微分方程的驗證**

伊藤引理（Itô's Lemma）是隨機微積分中的一個核心定理，它為處理隨機過程中的非線性問題提供了一種強有力的工具。伊藤引理描述了隨機過程變化的規律，並且能夠有效地應用於隨機微分方程（SDE）的求解中。在這一部分，我們將介紹伊藤引理的基本理論，並討論如何利用它來解隨機微分方程。

### 1. 伊藤引理的基本理論

假設 \( X(t) \) 是一個隨機過程，且 \( f(X(t)) \) 是一個光滑函數。那麼，根據伊藤引理，我們可以得到如下關係：

\[
df(X(t)) = f'(X(t)) dX(t) + \frac{1}{2} f''(X(t)) (dX(t))^2
\]

對於布朗運動 \( W(t) \)，我們有 \( dW(t)^2 = dt \)，所以上式可以簡化為：

\[
df(X(t)) = f'(X(t)) dX(t) + \frac{1}{2} f''(X(t)) dt
\]

這個公式告訴我們，對於隨機過程 \( X(t) \)，函數 \( f(X(t)) \) 的變化不僅依賴於 \( X(t) \) 的變化（即 \( dX(t) \)），還需要考慮 \( X(t) \) 的二階導數與 \( dX(t) \) 的平方項（即 \( dt \) 項）。這個公式是隨機微積分中至關重要的工具，並且在隨機微分方程的求解中有著廣泛的應用。

### 2. 隨機微分方程（SDE）的求解

隨機微分方程（Stochastic Differential Equation，SDE）是描述隨機過程的微分方程，它包含了隨機性，並且通常表示為：

\[
dX(t) = \mu(X(t), t) dt + \sigma(X(t), t) dW(t)
\]

其中，\( \mu(X(t), t) \) 是漂移項（drift term），\( \sigma(X(t), t) \) 是擴散項（diffusion term），而 \( W(t) \) 是標準布朗運動。

### 3. 使用伊藤引理求解隨機微分方程

假設我們有一個隨機微分方程，例如：

\[
dX(t) = \mu X(t) dt + \sigma X(t) dW(t)
\]

這是常見的幾何布朗運動模型。我們可以使用伊藤引理對其進行處理，並將 \( X(t) \) 代入函數 \( f(X(t)) = \ln(X(t)) \)。根據伊藤引理，我們得到：

\[
d \ln(X(t)) = \frac{1}{X(t)} dX(t) - \frac{1}{2X(t)^2} (dX(t))^2
\]

將 \( dX(t) \) 代入，我們可以得到：

\[
d \ln(X(t)) = \frac{\mu X(t)}{X(t)} dt + \frac{\sigma X(t)}{X(t)} dW(t) - \frac{1}{2} \frac{\sigma^2 X(t)^2}{X(t)^2} dt
\]

這將簡化為：

\[
d \ln(X(t)) = \left( \mu - \frac{1}{2} \sigma^2 \right) dt + \sigma dW(t)
\]

這樣，我們就能夠求解隨機微分方程的對數變換，從而更方便地進行數值解法。

### 4. Python實作：隨機微分方程的數值驗證

在這一部分，我們將使用 Python 來數值求解上述隨機微分方程，並驗證伊藤引理的應用。這裡我們使用歐拉-馬魯耶（Euler-Maruyama）方法來數值解SDE。

```python
import numpy as np
import matplotlib.pyplot as plt

# 設定參數
mu = 0.05  # 漂移項
sigma = 0.2  # 擴散項
T = 1.0  # 時間範圍
N = 1000  # 步數
dt = T / N  # 每步長度
X0 = 1.0  # 初始值

# 模擬布朗運動
dW = np.sqrt(dt) * np.random.randn(N)  # 隨機增量
W = np.cumsum(dW)  # 累加生成布朗運動

# 使用歐拉-馬魯耶法進行數值解法
X = np.zeros(N)
X[0] = X0
for t in range(1, N):
    X[t] = X[t-1] + mu * X[t-1] * dt + sigma * X[t-1] * dW[t-1]

# 畫出數值解
plt.plot(np.linspace(0, T, N), X)
plt.title("數值解：幾何布朗運動")
plt.xlabel("時間 t")
plt.ylabel("X(t)")
plt.show()
```

這段程式碼使用歐拉-馬魯耶法模擬了幾何布朗運動的隨機過程，並畫出其隨時間變化的軌跡。透過這樣的數值方法，我們可以驗證隨機微分方程的求解過程，並將其與伊藤引理的理論結果進行對比。

### 小結

- 伊藤引理提供了隨機過程中函數變化的規律，對於隨機微分方程的解法至關重要。
- 隨機微分方程是一種描述隨機過程的微分方程，具有漂移項和擴散項。
- 通過數值方法（如歐拉-馬魯耶法），我們可以對隨機微分方程進行求解並進行數值驗證。
- 本部分的數值實驗展示了伊藤引理的應用，並通過Python實現了隨機微積分的基本理論。