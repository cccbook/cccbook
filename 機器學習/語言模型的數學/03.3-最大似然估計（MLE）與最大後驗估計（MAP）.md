### **3.3 最大似然估計（MLE）與最大後驗估計（MAP）**

在統計學和機器學習中，參數估計是核心問題之一。當我們試圖估計模型的參數時，常用的方法有最大似然估計（MLE）和最大後驗估計（MAP）。這兩種方法都基於觀察到的數據來推斷未知的參數，但它們在如何處理不確定性和先驗信息上有所不同。

#### **3.3.1 最大似然估計（MLE）**

最大似然估計（Maximum Likelihood Estimation, MLE）是一種估計模型參數的方法，旨在使得在給定觀察數據的情況下，模型參數的似然函數達到最大值。直觀地說，MLE試圖找出最有可能生成觀察數據的模型參數。

##### **MLE的數學推導**

假設我們有一組觀察數據 \( \{x_1, x_2, \dots, x_n\} \)，這些數據來自某個隨機過程，其分佈由參數 \( \theta \) 控制。對於一個概率密度函數（或概率質量函數） \( p(x|\theta) \)，似然函數是所有觀察數據的聯合分佈：

\[
L(\theta) = \prod_{i=1}^n p(x_i|\theta)
\]

最大似然估計的目標是選擇使似然函數最大的參數 \( \theta \)：

\[
\hat{\theta}_{MLE} = \arg \max_\theta L(\theta)
\]

由於似然函數通常是積的形式，計算上較為麻煩，我們常常取對數似然函數，將積變為和：

\[
\ell(\theta) = \sum_{i=1}^n \log p(x_i|\theta)
\]

這樣最大化對數似然函數就成為了最大化似然函數的等價問題：

\[
\hat{\theta}_{MLE} = \arg \max_\theta \ell(\theta)
\]

#### **3.3.2 最大後驗估計（MAP）**

最大後驗估計（Maximum A Posteriori Estimation, MAP）是一種估計模型參數的方法，基於貝葉斯定理，在最大似然估計的基礎上進一步引入了參數的先驗分佈。與MLE不同，MAP方法不僅依賴於觀察數據的似然函數，還考慮了參數的先驗信息，這使得它在參數估計上更為靈活，特別是在數據稀缺或不確定性較高的情況下。

##### **MAP的數學推導**

根據貝葉斯定理，參數的後驗分佈可以表示為：

\[
p(\theta|x) = \frac{p(x|\theta) p(\theta)}{p(x)}
\]

其中：
- \( p(\theta|x) \) 是參數 \( \theta \) 給定觀察數據 \( x \) 的後驗分佈；
- \( p(x|\theta) \) 是觀察數據 \( x \) 在參數 \( \theta \) 下的似然函數；
- \( p(\theta) \) 是參數 \( \theta \) 的先驗分佈，反映了我們對參數的預期或先前的知識；
- \( p(x) \) 是數據的邊際似然，作為正規化常數，用來保證後驗分佈的總和（或積分）為1。

最大後驗估計的目標是最大化後驗分佈：

\[
\hat{\theta}_{MAP} = \arg \max_\theta p(\theta|x)
\]

由於 \( p(x) \) 不依賴於參數 \( \theta \)，因此可以忽略它，只關注似然函數和先驗分佈的積：

\[
\hat{\theta}_{MAP} = \arg \max_\theta p(x|\theta) p(\theta)
\]

通常，為了簡化計算，我們取對數後驗：

\[
\log p(\theta|x) = \log p(x|\theta) + \log p(\theta)
\]

因此，MAP的目標變為最大化對數後驗：

\[
\hat{\theta}_{MAP} = \arg \max_\theta \left( \log p(x|\theta) + \log p(\theta) \right)
\]

#### **3.3.3 MLE與MAP的區別**

1. **依賴於先驗信息**：
   - MLE只依賴於觀察數據 \( x \)，不考慮任何先驗信息；
   - MAP則結合了觀察數據和參數的先驗分佈，將先驗知識和數據進行綜合考慮。

2. **估計結果的差異**：
   - 當先驗分佈 \( p(\theta) \) 是均勻分佈或不對參數施加限制時，MAP會與MLE相同。
   - 當先驗信息非常強或數據較為稀疏時，MAP可能會比MLE提供更穩定或更合理的估計。

3. **適用情境**：
   - MLE適用於當數據充足且先驗信息較少或不確定時。
   - MAP適用於當數據不足或有較多先驗知識時，特別是在先驗信息能夠有效幫助改善估計的情況下。

#### **3.3.4 最大似然估計與最大後驗估計的應用**

- **最大似然估計（MLE）**：
  - 在參數估計中，MLE廣泛應用於許多領域，包括回歸分析、分類問題、時間序列預測等。
  - MLE可用於估計各種分佈的參數，如高斯分佈、指數分佈等，並且在數據量大的情況下，MLE往往能夠提供一致且有效的估計。

- **最大後驗估計（MAP）**：
  - MAP方法在機器學習中尤為重要，特別是在深度學習和貝葉斯推斷中。它被用於正則化問題，通過引入先驗分佈來防止過擬合。
  - 在貝葉斯網絡、隱馬爾可夫模型（HMM）、高斯混合模型（GMM）等領域，MAP可用來結合先驗知識和觀察數據進行有效的參數估計。

#### **3.3.5 小結**

最大似然估計（MLE）和最大後驗估計（MAP）是兩種常用的參數估計方法，MLE專注於從數據中估計參數，而MAP則結合了數據和先驗信息進行估計。MLE在數據充足且先驗信息不明的情況下通常表現良好，而MAP則在數據稀缺或先驗信息較強的情況下更具優勢。理解這兩種方法的基本原理及其區別，有助於在不同情境下選擇合適的參數估計方法。