### **1.4 最大似然估計（Maximum Likelihood Estimation, MLE）**

最大似然估計（MLE）是一種統計方法，用於估計模型中參數的最佳值，使得觀察到的數據在給定模型的條件下具有最大可能性。簡單來說，MLE尋找使得觀察到的數據最有可能出現的模型參數。

#### **1.4.1 最大似然估計的基本概念**

在機率模型中，假設我們有一組觀察數據  $`\{ x_1, x_2, \dots, x_n \}`$ ，並且這些數據來自一個具有參數  $`\theta`$  的隨機變數。根據概率論，數據的聯合機率（似然函數）是指在給定參數  $`\theta`$  的情況下，觀察到這組數據的機率。假設觀察數據是獨立同分佈的（i.i.d.），則似然函數  $`L(\theta)`$  可以表示為：


```math
L(\theta) = P(x_1, x_2, \dots, x_n | \theta) = \prod_{i=1}^{n} p(x_i | \theta)
```


其中  $`p(x_i | \theta)`$  是對應於參數  $`\theta`$  的單個觀察數據的概率質量函數或概率密度函數。

最大似然估計的目標是找到使似然函數最大化的參數值  $`\hat{\theta}`$ ：


```math
\hat{\theta}_{MLE} = \arg\max_{\theta} L(\theta)
```


由於最大化對數似然函數（對數似然函數是似然函數的對數）與最大化似然函數是等價的，通常會對似然函數取對數，這樣可以將乘積轉換為加法，使計算更為簡便。因此，對數似然函數  $`\ell(\theta)`$  為：


```math
\ell(\theta) = \log L(\theta) = \sum_{i=1}^{n} \log p(x_i | \theta)
```


MLE的最終目標是找到參數  $`\theta`$ ，使得對數似然函數達到最大值，即：


```math
\hat{\theta}_{MLE} = \arg\max_{\theta} \ell(\theta)
```


#### **1.4.2 最大似然估計的應用**

最大似然估計廣泛應用於各種機率模型的參數估計，以下是幾個常見的例子：

##### 1.4.2.1 伯努利分佈

假設我們觀察到  $`n`$  次伯努利試驗，成功的次數為  $`k`$ ，失敗的次數為  $`n - k`$ ，我們希望估計成功的機率  $`p`$ 。在這種情況下，伯努利分佈的機率質量函數為：


```math
p(x | p) = p^x (1 - p)^{1-x}, \quad x \in \{0, 1\}
```


其中  $`p`$  是未知的參數。假設我們觀察到的數據為  $`\{ x_1, x_2, \dots, x_n \}`$ ，其中每個  $`x_i`$  是 0 或 1。則似然函數為：


```math
L(p) = \prod_{i=1}^{n} p^{x_i} (1 - p)^{1 - x_i} = p^k (1 - p)^{n-k}
```


對這個似然函數取對數，得到對數似然函數：


```math
\ell(p) = k \log p + (n - k) \log (1 - p)
```


最大化對數似然函數得到的  $`p`$  是：


```math
\hat{p}_{MLE} = \frac{k}{n}
```


這也就是觀察數據中成功的比例。

##### 1.4.2.2 正態分佈

假設數據來自一個正態分佈，其概率密度函數為：


```math
p(x | \mu, \sigma^2) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)
```


其中  $`\mu`$  是均值， $`\sigma^2`$  是方差。我們希望估計正態分佈的參數  $`\mu`$  和  $`\sigma^2`$ 。假設觀察到的數據為  $`\{ x_1, x_2, \dots, x_n \}`$ ，則似然函數為：


```math
L(\mu, \sigma^2) = \prod_{i=1}^{n} \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left(-\frac{(x_i - \mu)^2}{2\sigma^2}\right)
```


取對數得到對數似然函數：


```math
\ell(\mu, \sigma^2) = -\frac{n}{2} \log(2 \pi \sigma^2) - \frac{1}{2 \sigma^2} \sum_{i=1}^{n} (x_i - \mu)^2
```


對  $`\mu`$  和  $`\sigma^2`$  分別求導並設為零，可以得到最大似然估計：


```math
\hat{\mu}_{MLE} = \frac{1}{n} \sum_{i=1}^{n} x_i
```



```math
\hat{\sigma^2}_{MLE} = \frac{1}{n} \sum_{i=1}^{n} (x_i - \hat{\mu})^2
```


這些估計值分別是數據的樣本均值和樣本方差。

#### **1.4.3 最大似然估計的性質**

- **一致性（Consistency）**：當樣本大小趨於無窮大時，最大似然估計通常會收斂於真實的參數值。
- **有效性（Efficiency）**：在大樣本情況下，最大似然估計達到Cramer-Rao下界，是一種最有效的估計方法。
- **偏倚性（Bias）**：在有限樣本中，最大似然估計可能會有偏差，但隨著樣本大小的增加，偏差會減小。

#### **1.4.4 最大似然估計的限制**

- **依賴樣本分佈**：最大似然估計的精確性取決於所選模型的正確性。如果假設的分佈不符合真實情況，MLE可能會產生不準確的估計。
- **計算複雜度**：對於複雜模型，MLE的計算可能涉及高維度的積分或求解複雜的方程式，這會增加計算的難度。

#### **1.4.5 小結**

最大似然估計是一種非常強大的統計方法，廣泛應用於參數估計中。它的主要目標是找到使得觀察到的數據在模型下出現的機率最大的參數。MLE具有一致性和有效性，但在實際應用中需要注意模型選擇和計算複雜度的問題。