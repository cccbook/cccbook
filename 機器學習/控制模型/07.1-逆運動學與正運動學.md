### 07.1 逆運動學與正運動學

在機器人控制領域，逆運動學（Inverse Kinematics, IK）和正運動學（Forward Kinematics, FK）是兩個至關重要的數學概念。它們用來描述和計算機器人末端執行器（如機械臂的手爪）的位置和姿態，根據關節的角度和位置進行轉換。這些運動學理論不僅是機器人運動規劃的基礎，也是機器人控制系統設計的核心。

#### 1. 正運動學（Forward Kinematics, FK）

正運動學是指根據已知的機器人關節角度（或位置）來計算機器人末端執行器的位置和姿態。這是從關節空間到工作空間（即，機器人末端的操作空間）的一個映射過程。

對於一個由多個關節構成的機器人，每個關節的運動會影響末端執行器的位置。正運動學模型將這些影響關聯在一起，通常涉及對每個關節的幾何關係進行分析。假設機器人是由一系列的連桿和關節組成，正運動學可以使用變換矩陣來描述各個關節和連桿之間的相對運動。

在數學上，正運動學問題可以表示為一組矩陣變換的連乘。對於一個具有 \( n \) 個關節的機器人，其末端執行器的位置和姿態是通過以下的運算獲得的：

\[
\mathbf{T}_n = \mathbf{T}_1 \cdot \mathbf{T}_2 \cdot \dots \cdot \mathbf{T}_n
\]

其中，\( \mathbf{T}_i \) 代表每個關節 i 的變換矩陣，它考慮了關節的角度、連桿的長度以及其他幾何因素。這些矩陣的乘積提供了末端執行器的位置信息，通常包括位置向量和姿態矩陣。

在一個簡單的二維機器人臂中，假設有兩個旋轉關節，則正運動學可以表示為：

\[
\mathbf{x} = L_1 \cos(\theta_1) + L_2 \cos(\theta_1 + \theta_2)
\]
\[
\mathbf{y} = L_1 \sin(\theta_1) + L_2 \sin(\theta_1 + \theta_2)
\]

其中 \( \mathbf{x} \) 和 \( \mathbf{y} \) 是末端執行器的位置，\( \theta_1 \) 和 \( \theta_2 \) 是兩個關節的角度，\( L_1 \) 和 \( L_2 \) 是連桿的長度。

#### 2. 逆運動學（Inverse Kinematics, IK）

逆運動學是從工作空間到關節空間的映射，即給定末端執行器的目標位置和姿態，求解對應的關節角度或位置。逆運動學是一個反向問題，通常比較難解決，因為一個目標位置可能對應多個解，或者在某些情況下，目標位置甚至無法達到（例如，超出了機器人的運動範圍）。

逆運動學的數學模型會根據機器人的結構和目標位置來計算每個關節的角度。這個問題通常需要求解一組非線性方程式，並且可能會出現多解或無解的情況。為了求解逆運動學問題，常用的方法包括：

- **解析方法**：通過幾何分析和代數推導，對機器人的運動學模型進行解析求解。這種方法僅適用於簡單的機器人結構，且對於複雜結構，解法可能會變得非常困難。
- **數值方法**：當解析方法無法直接使用時，常使用數值方法（如牛頓-拉弗森法或伪逆方法）來近似求解逆運動學問題。數值方法可以通過迭代計算來找到解，但可能需要進行多次嘗試和調整以避免不穩定解。

以二維機器人臂為例，給定末端執行器的目標位置 \( (x_d, y_d) \)，我們需要求解兩個關節角度 \( \theta_1 \) 和 \( \theta_2 \)。逆運動學的公式可以表示為：

\[
\theta_2 = \cos^{-1} \left( \frac{x_d^2 + y_d^2 - L_1^2 - L_2^2}{2 L_1 L_2} \right)
\]

然後，可以利用幾何關係求出 \( \theta_1 \)：

\[
\theta_1 = \tan^{-1}\left(\frac{y_d}{x_d}\right) - \tan^{-1}\left(\frac{L_2 \sin(\theta_2)}{L_1 + L_2 \cos(\theta_2)}\right)
\]

#### 3. 逆運動學的挑戰

逆運動學問題中，通常會遇到一些挑戰，主要包括：

- **多解性**：對於某些給定的目標位置，可能會有多組不同的關節角度解決方案。例如，在機器人臂設計中，可能存在多個方向可以到達同一目標點。
- **無解情況**：有時候，給定的目標位置超出了機器人臂的運動範圍，這會導致逆運動學無解。這要求設計者在規劃路徑時考慮機器人臂的可達性。
- **數值穩定性**：當使用數值方法求解逆運動學時，可能會出現收斂問題，特別是在接近奇異點或局部最小值時。

#### 4. 逆運動學和正運動學在控制中的應用

- **運動規劃**：在機器人控制中，正運動學和逆運動學被用於運動規劃。通過正運動學，機器人可以預測和追蹤末端執行器的位置；而逆運動學則使得機器人能夠根據末端執行器的目標位置來調整關節角度，實現精確控制。
  
- **視覺伺服控制**：視覺伺服控制是將視覺信息與運動控制結合的技術，通過逆運動學模型來使機器人達到視覺系統提供的目標位置。在這種情況下，逆運動學成為視覺伺服控制中的一個核心組件。

總結來說，正運動學和逆運動學是機器人控制理論中不可或缺的基本工具，幫助設計者從數學的角度理解和設計機器人的運動控制系統。通過這些技術，機器人可以在復雜的環境中進行精確的動作控制。