### 02.2 費雪最優化與庚定理

#### 1. 費雪最優化（Fisher Optimization）

費雪最優化是一種用於解決最優控制問題中與隨機或不確定性相關的問題的方法。它主要基於**費雪信息矩陣**，並利用它來進行估計和優化。費雪最優化的應用範圍廣泛，特別是在有噪聲或隨機干擾的系統中。

在最優控制中，費雪最優化的目的是最小化估計的方差或不確定性，並尋找最優的控制策略來補償或減少這些不確定性。

費雪最優化的數學基礎源於統計學中的費雪信息矩陣，它提供了一種評估控制系統在存在隨機性或測量誤差情況下的優化方法。其關鍵概念如下：

1. **費雪信息矩陣**：用來衡量參數估計的精確度。它與狀態變數的估計誤差有關，越高的費雪信息矩陣代表越高的估計精度。
   
   費雪信息矩陣可以表示為：
   
   \[
   \mathcal{I}(\theta) = -\mathbb{E} \left[ \frac{\partial^2 \log \mathcal{L}(\theta)}{\partial \theta^2} \right]
   \]

   其中，\( \mathcal{L}(\theta) \) 是似然函數，\( \theta \) 是模型的參數，\( \mathbb{E} \) 是期望運算。

2. **最優控制與不確定性**：在控制系統中，當控制信號受到隨機干擾或外部不確定性影響時，可以利用費雪最優化來最小化這些不確定性對系統性能的影響。這通常會導致更高效的控制策略。

3. **應用實例**：在實際應用中，費雪最優化通常會用於機器學習中的參數估計、濾波器設計（如卡爾曼濾波）以及自適應控制系統。通過使用費雪最優化方法，可以在系統的設計中最大化信息的利用效率，從而提高整體性能。

#### 2. 庚定理（Pontryagin's Maximum Principle）

庚定理是最優控制理論中的一個基本定理，主要用來解決有約束的最優控制問題。它為最優控制問題提供了一組條件，使得可以通過求解一個適當的哈密頓量（Hamiltonian）來尋找最優控制策略。

庚定理的數學形式如下：

#### 2.1 最優控制問題的哈密頓量

在最優控制問題中，我們通常面臨的數學形式為：

\[
\min_{u(t)} \int_{t_0}^{t_f} L(x(t), u(t), t) \, dt + \Phi(x(t_f))
\]

其中，\( x(t) \) 是系統狀態，\( u(t) \) 是控制輸入，\( L(x(t), u(t), t) \) 是即時成本函數，\( \Phi(x(t_f)) \) 是末端成本。

為了求解這樣的問題，庚定理引入了**哈密頓量**：

\[
H(x(t), u(t), \lambda(t)) = L(x(t), u(t), t) + \lambda(t)^T f(x(t), u(t))
\]

其中：
- \( \lambda(t) \) 是伴隨變數（Lagrange multiplier），其維度與系統狀態相同。
- \( f(x(t), u(t)) \) 是系統的動態方程。

#### 2.2 庚定理的必要條件

庚定理提供了一組條件，當這些條件滿足時，控制策略 \( u(t) \) 就是最優的。這些條件包括：

1. **哈密頓量最大化條件**：最優控制必須使得哈密頓量 \( H(x(t), u(t), \lambda(t)) \) 相對於控制變量 \( u(t) \) 最大化，即：

   \[
   \frac{\partial H}{\partial u(t)} = 0
   \]

2. **狀態方程**：系統的狀態遵循其動態方程，並且必須滿足最優控制問題的動態約束，即：

   \[
   \dot{x}(t) = f(x(t), u(t)), \quad x(t_0) = x_0
   \]

3. **伴隨變數方程**：伴隨變數 \( \lambda(t) \) 必須滿足以下方程，這是從最優性條件推導出來的：

   \[
   \dot{\lambda}(t) = -\frac{\partial H}{\partial x(t)}
   \]

   並且，\( \lambda(t_f) = \frac{\partial \Phi}{\partial x(t_f)} \) 是末端條件。

#### 2.3 庚定理的應用

庚定理在最優控制問題中的應用非常廣泛，尤其是在有約束的最優控制問題中。其應用範疇包括：

- **經濟學**：最優資源分配和生產決策。
- **機器人控制**：為機器人規劃最優的運動軌跡。
- **航天工程**：最優火箭發射策略和航天器軌跡規劃。
- **自駕車**：最優路徑規劃，考慮到車輛運動學和道路約束。

#### 3. 費雪最優化與庚定理的關聯

費雪最優化和庚定理是最優控制理論中兩個重要的工具，它們可以結合使用來解決有不確定性或噪聲影響的最優控制問題。在這種情況下，庚定理提供了最優控制問題的結構，而費雪最優化則可用來處理由隨機因素引起的問題，從而更好地解決實際問題中的不確定性。

---

總結來說，費雪最優化和庚定理是最優控制理論中的兩個基礎工具。費雪最優化強調如何最小化不確定性，並用費雪信息矩陣進行優化；而庚定理則提供了解決最優控制問題的必要條件，並依賴於哈密頓量來尋找最優控制策略。這兩者的結合在許多實際應用中具有重要意義，尤其是在處理隨機性和不確定性的控制問題時。