### 5.2 遞迴關係與生成函數（Recurrence Relations and Generating Functions）

遞迴關係是描述數列中每一項與其前幾項之間相依關係的方程式。使用生成函數來求解遞迴關係是一種常見且強大的方法。生成函數能夠將遞迴關係轉化為代數方程，從而讓我們可以使用代數技巧來解這些遞迴關係。

#### 5.2.1 遞迴關係的基本概念

遞迴關係描述了數列的每一項是如何由前面的項來表示的。例如，對於數列  $`\{a_n\}`$ ，如果我們知道每一項的計算方式是基於前面一些項的話，就形成了一個遞迴關係。

常見的遞迴關係類型有：
- **線性遞迴關係**：數列的項是前幾項的線性組合。
  - 例如： $`a_n = 3a_{n-1} + 2a_{n-2}`$ 
- **常係數遞迴關係**：遞迴關係的係數是常數。
  - 例如： $`a_n = 2a_{n-1} + 5`$ 
- **非線性遞迴關係**：數列的項與前面項的乘積或其他非線性組合有關。
  - 例如： $`a_n = a_{n-1} \cdot a_{n-2}`$ 

遞迴關係的目標是找到數列  $`\{a_n\}`$  的封閉形式（closed form），即數列中第  $`n`$  項的明確表示式。

#### 5.2.2 使用生成函數求解遞迴關係

生成函數可以有效地解決許多線性遞迴關係。過程通常包含以下步驟：

1. **建立生成函數**：
   對於數列  $`\{a_n\}`$ ，其生成函數  $`A(x)`$  定義為：
   
```math
A(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \cdots = \sum_{n=0}^{\infty} a_n x^n
```

   
2. **代入遞迴關係**：
   假設數列  $`\{a_n\}`$  滿足遞迴關係，如  $`a_n = p a_{n-1} + q a_{n-2} + r`$ ，我們可以將遞迴關係代入生成函數。

3. **簡化並解出生成函數**：
   使用代數運算將生成函數轉換成一個可以直接求解的形式。通過這個生成函數，我們可以推導出數列的閉式解。

4. **提取數列的項**：
   將求得的生成函數展開並提取各項的係數，得到數列的封閉形式。

#### 5.2.3 例子：解線性遞迴關係

考慮一個簡單的線性遞迴關係：


```math
a_n = 3a_{n-1} + 2a_{n-2} \quad \text{(對於} n \geq 2\text{，且初始條件為} a_0 = 1, a_1 = 2\text{)}
```


1. **建立生成函數**：
   定義生成函數  $`A(x)`$ ：
   
```math
A(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \cdots = \sum_{n=0}^{\infty} a_n x^n
```


2. **代入遞迴關係**：
   從遞迴關係中，我們知道：
   
```math
a_n = 3a_{n-1} + 2a_{n-2}
```

   將這個關係代入生成函數中：
   
```math
A(x) - a_0 - a_1 x = 3x \left( A(x) - a_0 \right) + 2x^2 A(x)
```

   
3. **簡化方程**：
   將初始條件  $`a_0 = 1`$ ,  $`a_1 = 2`$  代入後得到：
   
```math
A(x) - 1 - 2x = 3x(A(x) - 1) + 2x^2 A(x)
```

   展開並整理：
   
```math
A(x) - 1 - 2x = 3x A(x) - 3x + 2x^2 A(x)
```

   
```math
A(x) - 3x A(x) - 2x^2 A(x) = 1 - 2x + 3x
```

   
```math
(1 - 3x - 2x^2) A(x) = 1 + x
```

   
```math
A(x) = \frac{1 + x}{1 - 3x - 2x^2}
```


4. **提取數列的項**：
   現在，生成函數  $`A(x)`$  可以進一步簡化並展開為冪級數形式來提取數列的項。這通常涉及部分分式分解，或者可以使用某些特殊技巧來獲得數列的封閉形式。

#### 5.2.4 常見的遞迴關係及其生成函數解法

1. **斐波那契數列**：
   斐波那契數列滿足遞迴關係：
   
```math
F_n = F_{n-1} + F_{n-2}, \quad F_0 = 0, F_1 = 1
```

   其生成函數為：
   
```math
F(x) = \frac{x}{1 - x - x^2}
```

   可以通過這個生成函數得到斐波那契數列的封閉式解。

2. **等差數列**：
   等差數列滿足遞迴關係：
   
```math
a_n = a_{n-1} + d, \quad a_0 = 0
```

   其生成函數為：
   
```math
A(x) = \frac{a_0}{1 - x} + \frac{d x}{(1 - x)^2}
```

   這可以解出數列的封閉解。

#### 5.2.5 結論

生成函數提供了一種強大的方法來求解遞迴關係，特別是對於線性遞迴關係。將遞迴關係轉換為生成函數後，我們可以利用代數技巧（如簡化、展開、提取係數等）來找到數列的封閉式解。這不僅簡化了解決過程，還使得我們能夠處理許多組合數學中的複雜問題。