### 10.4 ARMA與ARIMA模型

在時間序列分析中，ARMA（自迴歸移動平均）和ARIMA（自迴歸積分移動平均）模型是非常常用的模型。這些模型結合了自迴歸模型（AR）和移動平均模型（MA），並能夠處理非平穩數據，廣泛應用於預測和模式識別中。

#### 10.4.1 ARMA模型

ARMA模型（Autoregressive Moving Average Model）是一種用來描述和預測平穩時間序列的方法。它結合了自迴歸模型（AR）和移動平均模型（MA），適用於平穩的時間序列數據。

ARMA模型的數學表示為：


```math
y_t = \mu + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q}
```


其中：
-  $`y_t`$  是時間  $`t`$  的觀測值。
-  $`\mu`$  是常數項，表示時間序列的長期平均值。
-  $`\phi_1, \phi_2, \dots, \phi_p`$  是自迴歸項（AR）的係數，控制過去觀察值的影響。
-  $`\epsilon_t`$  是白噪聲誤差項。
-  $`\theta_1, \theta_2, \dots, \theta_q`$  是移動平均項（MA）的係數，控制過去誤差的影響。
-  $`p`$  是自迴歸項的階數， $`q`$  是移動平均項的階數。

#### 10.4.2 ARMA模型的階數選擇

選擇ARMA模型的階數（即  $`p`$  和  $`q`$  的值）是建立模型的重要步驟。階數選擇的常見方法包括：
- **自相關函數（ACF）和偏自相關函數（PACF）圖**：通過分析ACF和PACF圖來確定AR和MA項的階數。ACF和PACF圖可以顯示時間序列中觀測值之間的相關性，從而指導階數的選擇。
- **信息準則（如AIC、BIC）**：使用Akaike信息準則（AIC）或貝葉斯信息準則（BIC）來評估不同階數的模型，選擇最合適的模型。

#### 10.4.3 ARMA模型的估計

ARMA模型的估計通常使用最小二乘法或最大似然估計法。具體步驟包括：
1. 設定模型的階數  $`p`$  和  $`q`$ 。
2. 使用數據估計模型的參數（自迴歸係數和移動平均係數）。
3. 驗證模型是否符合假設（例如，誤差項是否為白噪聲）。

#### 10.4.4 ARIMA模型

ARIMA（Autoregressive Integrated Moving Average）模型是一種擴展的ARMA模型，用於處理非平穩時間序列。ARIMA模型通過引入積分操作（差分）來使非平穩數據轉化為平穩數據，從而能夠應用ARMA模型進行分析。

ARIMA模型的數學表示為：


```math
(1 - \phi_1 B - \phi_2 B^2 - \dots - \phi_p B^p)(1 - B)^d y_t = \epsilon_t + \theta_1 B \epsilon_{t-1} + \theta_2 B \epsilon_{t-2} + \dots + \theta_q B \epsilon_{t-q}
```


其中：
-  $`B`$  是滯後算子（lag operator），即  $`B^k y_t = y_{t-k}`$ 。
-  $`d`$  是差分階數，表示對數據進行幾次差分操作以達到平穩狀態。
- 其餘符號與ARMA模型相同。

#### 10.4.5 ARIMA模型的階數選擇

ARIMA模型的階數選擇需要確定三個參數：
- **自迴歸項的階數  $`p`$ **：這決定了過去觀察值的影響。
- **差分階數  $`d`$ **：這決定了對時間序列進行多少次差分，使其變為平穩序列。
- **移動平均項的階數  $`q`$ **：這決定了過去誤差項的影響。

選擇階數的常見方法包括：
- **差分檢驗**：利用單位根檢驗（如ADF檢驗）來檢查時間序列的平穩性，確定需要多少次差分。
- **ACF和PACF圖**：分析差分後時間序列的ACF和PACF圖來確定AR和MA項的階數。
- **信息準則（如AIC、BIC）**：使用信息準則來選擇最佳的階數。

#### 10.4.6 ARIMA模型的估計與預測

與ARMA模型類似，ARIMA模型的參數估計通常使用最大似然估計或最小二乘法。預測時，ARIMA模型利用過去的觀測值和誤差項來預測未來的數據。預測公式如下：


```math
\hat{y}_{t+h} = \mu + \sum_{i=1}^{p} \phi_i \hat{y}_{t+h-i} + \sum_{j=1}^{q} \theta_j \epsilon_{t+h-j}
```


這裡，  $`\hat{y}_{t+h}`$  是對未來  $`h`$  期的預測，並且預測依賴於過去的數據和誤差項。

#### 10.4.7 ARMA與ARIMA模型的應用

ARMA和ARIMA模型廣泛應用於時間序列預測和分析，具體的應用包括：
- **經濟預測**：如股市價格、GDP增長率、通脹率等。
- **需求預測**：例如零售銷售額、交通流量等。
- **氣象預測**：如氣溫、降水量等。

這些模型能夠捕捉時間序列中的趨勢和周期性變化，並根據過去的數據做出合理的預測。

#### 10.4.8 小結

ARMA模型適用於平穩時間序列，而ARIMA模型則能處理非平穩序列，通過差分將其轉化為平穩序列。這些模型結合了自迴歸和移動平均的思想，是時間序列分析中重要的工具。選擇適當的模型階數和差分階數，對模型的估計和預測至關重要。