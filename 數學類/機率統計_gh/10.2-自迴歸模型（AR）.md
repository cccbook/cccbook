### 10.2 自迴歸模型（AR）

自迴歸模型（AutoRegressive Model，簡稱 AR）是時間序列分析中的一種基本模型，主要用於描述時間序列中某個變數的當前值如何與其過去的觀測值相關。AR 模型假設當前的數據點是過去數據點的線性組合，並且這些過去的數據點能夠有效地解釋當前的數據。

#### 10.2.1 自迴歸模型的基本概念

在 AR 模型中，當前的觀測值  $`y_t`$  被表示為過去觀測值的線性組合，並加上隨機誤差項  $`\epsilon_t`$ ，具體形式如下：


```math
y_t = \alpha_0 + \alpha_1 y_{t-1} + \alpha_2 y_{t-2} + \dots + \alpha_p y_{t-p} + \epsilon_t
```


其中：
-  $`y_t`$  為時間  $`t`$  的觀測值。
-  $`\alpha_0`$  是模型的截距項。
-  $`\alpha_1, \alpha_2, \dots, \alpha_p`$  是模型的自迴歸係數（AR 係數）。
-  $`\epsilon_t`$  是隨機誤差項，通常假設其為白噪聲，即均值為零、方差穩定、無自相關的隨機過程。
-  $`p`$  是自迴歸模型的階數，表示使用多少個過去的數據點來解釋當前的數據點。

#### 10.2.2 自迴歸模型的階數選擇

AR 模型的階數  $`p`$  是一個重要的超參數，決定了模型中所考慮的過去觀測值的數量。選擇合適的階數對於模型的預測能力至關重要。階數選擇的方法通常包括：
- **ACF 和 PACF 圖分析**：自相關圖（ACF）和偏自相關圖（PACF）可以幫助識別時間序列中應考慮的延遲期數。通常，PACF 在某個階數後迅速衰減，這個階數就是 AR 模型的最佳階數。
- **信息準則**：例如赤池信息準則（AIC）或貝葉斯信息準則（BIC），可以用來比較不同階數下的模型，選擇能夠最小化這些準則的模型。

#### 10.2.3 自迴歸模型的估計

在 AR 模型中，我們需要估計模型的參數（即 AR 係數  $`\alpha_1, \alpha_2, \dots, \alpha_p`$ ）。這些參數通常使用最小二乘法（OLS）來估計。最小二乘法的基本思想是最小化實際數據點和模型預測值之間的誤差平方和。

AR 模型的參數估計步驟如下：
1. 設定模型的階數  $`p`$ 。
2. 通過最小二乘法或最大似然估計法（MLE）計算出自迴歸係數。
3. 驗證模型的適配度，檢查殘差項（誤差項）是否符合白噪聲假設。

#### 10.2.4 自迴歸模型的預測

AR 模型的預測基於歷史數據的線性組合。在已知歷史數據的情況下，預測未來的數據可以通過以下方式進行：


```math
\hat{y}_{t+1} = \alpha_0 + \alpha_1 y_t + \alpha_2 y_{t-1} + \dots + \alpha_p y_{t-p+1}
```


這裡  $`\hat{y}_{t+1}`$  是對未來值  $`y_{t+1}`$  的預測，利用最近的  $`p`$  個時間點的數據來預測下一時間點的數據。

#### 10.2.5 AR 模型的特點與優勢

- **簡單性與解釋性**：AR 模型結構簡單，易於理解，適合用於描述平穩時間序列中的線性關係。
- **計算效率高**：AR 模型的參數估計和預測計算較為高效，特別適用於短期預測。
- **能夠捕捉依賴性**：AR 模型能夠捕捉時間序列中的自相關性，對於具有長期記憶的時間序列非常有效。

#### 10.2.6 自迴歸模型的局限性

- **僅適用於平穩序列**：AR 模型假設序列是平穩的，因此在處理非平穩時間序列（如存在趨勢或季節性）時，需要對數據進行差分或其他變換，使其平穩。
- **對於高階自迴歸的計算量較大**：當階數  $`p`$  很高時，AR 模型可能會變得過於複雜，並且對計算資源的需求也會增加。
- **無法捕捉非線性關係**：AR 模型假設時間序列中每個觀測值與過去觀測值之間是線性關係，這使得 AR 模型在處理具有非線性關係的時間序列時可能不夠有效。

#### 10.2.7 小結

自迴歸模型（AR）是時間序列分析中的一個基本工具，適用於描述過去觀測值與當前數據之間的線性關係。AR 模型的簡單性和計算效率使其成為許多時間序列預測問題的首選方法。然而，AR 模型對於非平穩或非線性時間序列的處理有限，因此在使用時需要考慮數據的特徵並選擇合適的階數。