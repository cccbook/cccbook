### 馬可夫鏈的轉移矩陣

馬可夫鏈的**轉移矩陣**（Transition Matrix）是描述系統從一個狀態轉移到另一個狀態的概率結構。轉移矩陣是馬可夫鏈的核心元素之一，它決定了系統隨時間進行狀態變化的規律。

#### 1. 轉移矩陣的定義

假設一個馬可夫鏈的狀態空間是  $`S = \{s_1, s_2, \dots, s_k\}`$ ，則轉移矩陣  $`P`$  是一個  $`k \times k`$  的矩陣，其中每個元素  $`P(i, j)`$  表示從狀態  $`s_i`$  轉移到狀態  $`s_j`$  的條件概率，並滿足以下條件：

-  $`0 \leq P(i, j) \leq 1`$ ，每個轉移概率都非負且不超過1。
- 每一行的和為1，即從某一狀態出發，必定會轉移到某個狀態。這是因為每一行的概率分佈描述了從當前狀態到其他狀態的轉移情況，總和必須為1：
  
```math
\sum_{j=1}^k P(i, j) = 1 \quad \text{對所有} \quad i = 1, 2, \dots, k
```


因此，轉移矩陣  $`P`$  的形式如下：


```math
P = \begin{pmatrix}
P(1, 1) & P(1, 2) & \cdots & P(1, k) \\
P(2, 1) & P(2, 2) & \cdots & P(2, k) \\
\vdots & \vdots & \ddots & \vdots \\
P(k, 1) & P(k, 2) & \cdots & P(k, k)
\end{pmatrix}
```


其中， $`P(i, j)`$  表示從狀態  $`s_i`$  轉移到狀態  $`s_j`$  的機率。

#### 2. 轉移矩陣的性質

轉移矩陣的性質是理解和分析馬可夫鏈行為的關鍵。這些性質有助於我們理解系統的長期行為，以及馬可夫鏈是否有穩定的狀態分佈。

- **行和為1**：每行的元素之和等於1，這是因為從任意狀態出發，總有一個狀態被達到。

- **機率非負性**：矩陣中的所有元素  $`P(i, j) \geq 0`$ ，即每一個轉移概率都是非負數。

- **冪次矩陣**：轉移矩陣的冪次（如  $`P^n`$ ）表示經過  $`n`$  步轉移後，從某個初始狀態到達其他各個狀態的概率。即：
  
```math
P^n = P \times P \times \cdots \times P \quad (\text{n次矩陣乘積})
```

  這表示從當前狀態出發，經過  $`n`$  步後，系統達到其他狀態的機率。

- **長期行為**：如果馬可夫鏈存在平穩分佈  $`\pi`$ ，那麼對於任意初始分佈  $`\pi_0`$ ，經過多次轉移後，系統的狀態分佈將趨於  $`\pi`$ 。這樣的情況通常發生在馬可夫鏈是**不可約**且**遍歷**的情況下。

#### 3. 轉移矩陣的例子

假設有一個簡單的二狀態馬可夫鏈，其中狀態空間為  $`S = \{s_1, s_2\}`$ ，狀態  $`s_1`$  和  $`s_2`$  的轉移概率如下所示：

- 從狀態  $`s_1`$  轉移到  $`s_1`$  的概率是 0.7，轉移到  $`s_2`$  的概率是 0.3。
- 從狀態  $`s_2`$  轉移到  $`s_1`$  的概率是 0.4，轉移到  $`s_2`$  的概率是 0.6。

則該馬可夫鏈的轉移矩陣為：


```math
P = \begin{pmatrix}
0.7 & 0.3 \\
0.4 & 0.6
\end{pmatrix}
```


這個轉移矩陣表示了從狀態  $`s_1`$  和  $`s_2`$  之間的轉移概率。可以看到，對於每個狀態，每一行的和為 1。

#### 4. 轉移矩陣的應用

- **計算長期概率分佈**：如果馬可夫鏈達到平穩狀態，即系統達到了穩定分佈，我們可以通過解以下的方程來計算平穩分佈：
  
```math
\pi = \pi P
```

  這是一個線性方程組，其中  $`\pi`$  是平穩分佈的向量，解這個方程組即可找到系統長期穩定時各狀態的概率。

- **多步轉移計算**：透過計算  $`P^n`$ ，我們可以得到在  $`n`$  步後，從某個初始狀態轉移到其他狀態的概率。這對於預測系統在未來某個時間步的行為非常有用。

#### 小結

馬可夫鏈的轉移矩陣是一個核心概念，它描述了從一個狀態到另一個狀態的轉移機率。理解轉移矩陣的結構和性質對於分析和預測馬可夫鏈的行為至關重要，尤其是在計算長期穩定分佈或多步轉移概率時。