### 馬可夫鏈的長期行為與極限分佈

馬可夫鏈的長期行為是指當馬可夫鏈運行足夠長時間後，系統的狀態分佈會趨於穩定並不再隨時間改變。這種穩定的分佈被稱為**極限分佈**（或稱為平穩分佈）。極限分佈描述了馬可夫鏈在長時間運行下的狀態分佈，並且這一分佈依賴於轉移矩陣的結構。

#### 1. **長期行為的基本概念**

當馬可夫鏈進行多次轉移後，鏈的狀態分佈會逐漸趨向於一個穩定的分佈。這種分佈稱為馬可夫鏈的**平穩分佈**或**極限分佈**。即，對於長期的行為，無論從哪個初始狀態開始，馬可夫鏈的狀態分佈將最終穩定在這個平穩分佈上。

設狀態空間為  $`S = \{ s_1, s_2, \dots, s_n \}`$ ，並且轉移矩陣為  $`P`$ ，長期行為的數學表示可以寫作：


```math
\pi = \pi P
```


其中， $`\pi = (\pi_1, \pi_2, \dots, \pi_n)`$  是平穩分佈向量，表示在長期運行中，系統處於每個狀態  $`s_i`$  的概率。此方程稱為平穩方程，它描述了狀態分佈不再隨時間改變。

#### 2. **極限分佈的存在性與唯一性**

馬可夫鏈的極限分佈是否存在，取決於鏈的結構。對於一個馬可夫鏈，極限分佈的存在性和唯一性與以下條件有關：

- **不可約性（Irreducibility）**：若馬可夫鏈是不可約的，即任意兩個狀態之間都能夠相互達到，那麼鏈的長期行為會趨向於一個穩定的分佈。
  
- **正則性（Regularity）**：若馬可夫鏈是正則的，即每個狀態都可以在有限步數內到達任何其他狀態，那麼該馬可夫鏈的極限分佈存在且是唯一的。

- **遍歷性（Aperiodicity）**：若馬可夫鏈的返回期（從狀態回到自身的步數）不固定，則該鏈是遍歷的，這樣可以保證其平穩分佈的存在。

當馬可夫鏈是不可約且遍歷時，則其極限分佈一定是唯一的，並且隨著時間的推移，系統的狀態分佈會趨近於此平穩分佈。

#### 3. **計算極限分佈**

計算馬可夫鏈的極限分佈可以透過解平穩方程來實現。具體方法如下：

1. **構造平穩方程**：對於一個  $`n`$ -狀態的馬可夫鏈，平穩分佈向量  $`\pi`$  需要滿足以下條件：


```math
\pi P = \pi
```


以及正規化條件：


```math
\sum_{i=1}^{n} \pi_i = 1
```


2. **求解方程**：這是一組線性方程組，通常可以使用數值方法（如高斯消元法、最小二乘法等）來解。

3. **驗證解的穩定性**：求得的  $`\pi`$  向量需要符合上述正規化條件，即所有分佈的總和為1，並且每個元素的概率大於或等於零。

#### 4. **例子：兩狀態馬可夫鏈**

考慮一個兩狀態的馬可夫鏈，其轉移矩陣為：


```math
P = \begin{pmatrix}
0.6 & 0.4 \\
0.2 & 0.8
\end{pmatrix}
```


我們要求該鏈的平穩分佈。

設平穩分佈為  $`\pi = (\pi_1, \pi_2)`$ ，根據平穩方程，我們有：


```math
\pi_1 = 0.6\pi_1 + 0.2\pi_2
```



```math
\pi_2 = 0.4\pi_1 + 0.8\pi_2
```


再加上正規化條件：


```math
\pi_1 + \pi_2 = 1
```


解這組方程，我們得到：


```math
\pi_1 = \frac{2}{3}, \quad \pi_2 = \frac{1}{3}
```


因此，該馬可夫鏈的平穩分佈為  $`\pi = \left( \frac{2}{3}, \frac{1}{3} \right)`$ 。

#### 5. **收斂性與長期行為**

對於大多數不可約且遍歷的馬可夫鏈，其長期行為會趨向於平穩分佈，並且不受初始狀態的影響。這意味著，無論從哪個初始狀態開始，系統的狀態分佈都會最終穩定下來，並維持在極限分佈上。

例如，在前面的例子中，無論初始狀態為  $`s_1`$  還是  $`s_2`$ ，隨著步數的增加，系統的狀態分佈會趨近於  $`\pi = \left( \frac{2}{3}, \frac{1}{3} \right)`$ 。

#### 小結

馬可夫鏈的長期行為由其極限分佈決定，該分佈反映了系統在多次轉移後的穩定狀態。極限分佈的存在性和唯一性通常依賴於馬可夫鏈的不可約性、正則性和遍歷性等性質。在計算極限分佈時，通常需要解一組線性方程，並且這些方法在各種隨機過程和強化學習模型中得到了廣泛應用。