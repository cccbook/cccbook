### 5.2 邊際分布與條件分布

在多元隨機變數的分析中，邊際分布和條件分布是兩個關鍵概念。邊際分布用來描述單一隨機變數的行為，而條件分布則描述在已知其他變數值的條件下，某一變數的行為。

#### 5.2.1 邊際分布

邊際分布描述的是在多元隨機變數的情況下，單一隨機變數的機率分佈。換句話說，邊際分布是通過“忽略”其他變數，將其從聯合分布中去除，得到單一變數的分布。

對於離散型隨機變數，假設 \( X \) 和 \( Y \) 是兩個離散隨機變數，它們的聯合機率質量函數（PMF）為 \( P(X = x, Y = y) \)。那麼 \( X \) 的邊際分布 \( P_X(x) \) 是通過對 \( Y \) 進行求和得到的：

\[
P_X(x) = \sum_{y} P(X = x, Y = y)
\]

這表示 \( X \) 取某一值 \( x \) 的總機率，無論 \( Y \) 的值為何。

對於連續型隨機變數，假設 \( X \) 和 \( Y \) 是兩個連續隨機變數，它們的聯合機率密度函數（PDF）為 \( f_{X,Y}(x, y) \)，那麼 \( X \) 的邊際分布 \( f_X(x) \) 是通過對 \( Y \) 進行積分得到的：

\[
f_X(x) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dy
\]

這表示 \( X \) 的機率密度，無論 \( Y \) 的值為何。

#### 5.2.2 條件分布

條件分布描述的是在已知其他隨機變數的取值下，某一隨機變數的分佈。對於兩個隨機變數 \( X \) 和 \( Y \)，在已知 \( Y = y \) 的條件下，\( X \) 的條件機率質量函數（PMF）為：

\[
P(X = x | Y = y) = \frac{P(X = x, Y = y)}{P_Y(y)}
\]

這表示在 \( Y = y \) 的條件下，\( X \) 取值 \( x \) 的機率。此處，\( P_Y(y) \) 是 \( Y \) 的邊際機率，即 \( P_Y(y) = \sum_{x} P(X = x, Y = y) \) 或對於連續情況，\( P_Y(y) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dx \)。

對於連續型隨機變數，條件機率密度函數（PDF）為：

\[
f_{X|Y}(x | y) = \frac{f_{X,Y}(x, y)}{f_Y(y)}
\]

這表示在 \( Y = y \) 的條件下，\( X \) 取值 \( x \) 的機率密度。

條件分布的直觀解釋是，條件分布描述了當我們已經知道 \( Y \) 這個隨機變數的具體取值時，隨機變數 \( X \) 的分佈會如何改變。

#### 5.2.3 邊際分布與條件分布的關係

邊際分布和條件分布之間存在著密切的關聯。利用條件分布，我們可以重新構造聯合分布，這樣的公式被稱為“全概率公式”：

\[
P(X = x) = \sum_{y} P(X = x | Y = y) P_Y(y)
\]

對於連續情況，這一公式可以寫為：

\[
f_X(x) = \int_{-\infty}^{\infty} f_{X|Y}(x | y) f_Y(y) \, dy
\]

這表明，邊際分布 \( P_X(x) \) 或 \( f_X(x) \) 可以通過條件分布 \( P(X = x | Y = y) \) 或 \( f_{X|Y}(x | y) \) 以及 \( Y \) 的邊際分布 \( P_Y(y) \) 或 \( f_Y(y) \) 來計算。

#### 5.2.4 例子

1. **離散隨機變數的邊際分布和條件分布**

   假設兩個離散隨機變數 \( X \) 和 \( Y \) 的聯合PMF如下所示：

   \[
   P(X = x, Y = y) = \begin{cases}
   \frac{1}{6}, & \text{若 } x = 1, 2, 3 \text{ 且 } y = 1, 2, 3 \\
   0, & \text{其他情況}
   \end{cases}
   \]

   - 邊際分布 \( P_X(x) \) 為：

     \[
     P_X(x) = \sum_{y=1}^{3} P(X = x, Y = y) = \frac{1}{6} + \frac{1}{6} + \frac{1}{6} = \frac{1}{2}, \quad x = 1, 2, 3
     \]

   - 條件分布 \( P(X = x | Y = y) \) 為：

     \[
     P(X = x | Y = y) = \frac{P(X = x, Y = y)}{P_Y(y)} = \frac{\frac{1}{6}}{\frac{1}{2}} = \frac{1}{3}, \quad x = 1, 2, 3, \quad y = 1, 2, 3
     \]

2. **連續隨機變數的邊際分布和條件分布**

   假設 \( X \) 和 \( Y \) 服從均勻分布，其聯合PDF為：

   \[
   f_{X,Y}(x, y) = \begin{cases}
   \frac{1}{2}, & 0 \leq x \leq 1, 0 \leq y \leq 1 \\
   0, & \text{其他情況}
   \end{cases}
   \]

   - 邊際分布 \( f_X(x) \) 為：

     \[
     f_X(x) = \int_0^1 \frac{1}{2} \, dy = \frac{1}{2}, \quad 0 \leq x \leq 1
     \]

   - 條件分布 \( f_{X|Y}(x | y) \) 為：

     \[
     f_{X|Y}(x | y) = \frac{f_{X,Y}(x, y)}{f_Y(y)} = \frac{\frac{1}{2}}{\frac{1}{2}} = 1, \quad 0 \leq x \leq 1
     \]

#### 5.2.5 小結

邊際分布和條件分布是多元隨機變數分析中的重要工具。邊際分布揭示了單一隨機變數的行為，而條件分布則描述了在已知某些變數取值的情況下，其他變數的行為。這兩者不僅在理論上有著緊密的聯繫，實際應用中也具有重要意義，例如在統計推斷、模型構建以及數據分析中都扮演著重要角色。