### 11.4 馬可夫鏈蒙地卡羅法（MCMC）

馬可夫鏈蒙地卡羅法（Markov Chain Monte Carlo, MCMC）是一種強大的貝葉斯推論工具，用於從複雜的後驗分布中進行抽樣。MCMC 利用馬可夫鏈的概念，將問題轉化為多次隨機抽樣的過程，從而在高維度、複雜模型中估計後驗分布。

#### 11.4.1 MCMC 基本原理

MCMC 方法的核心思想是構造一個馬可夫鏈，使得該鏈的穩態分布（即長期運行後的分布）就是我們關心的目標分布，通常是後驗分布。經過足夠多的步驟後，馬可夫鏈將能夠生成目標分布的樣本。這些樣本可以用來進行各種統計推斷，例如估計期望、方差等。

具體步驟如下：

1. **初始化**：從某個初始狀態開始，這通常是從隨機或指定的點開始。
2. **迭代**：在每一步中，根據某種轉移規則從當前狀態生成下一個狀態。這個轉移規則應該設計成使得最終穩態分布是目標後驗分布。
3. **收集樣本**：經過多次迭代後，收集馬可夫鏈中的樣本，這些樣本會來自目標後驗分布。

由於 MCMC 依賴於馬可夫鏈的運行，鏈的長度必須足夠長，才能使樣本接近目標分布。通常在進行估計前，需要進行“燃燒期”（burn-in），以排除初始狀態對結果的影響。

#### 11.4.2 MCMC 方法的主要步驟

MCMC 的基本框架是從一個簡單的分布出發，並通過逐步的過程將其轉換為目標分布。最常見的 MCMC 算法有 **Metropolis-Hastings 算法** 和 **Gibbs 采樣**。

##### 11.4.2.1 Metropolis-Hastings 算法

Metropolis-Hastings 是最基本的 MCMC 方法之一，通過以下步驟進行抽樣：

1. 假設當前狀態為 \( \theta^{(t)} \)，從一個提議分布 \( q(\theta' | \theta^{(t)}) \) 中生成一個候選點 \( \theta' \)。
2. 計算接受概率：

   \[
   \alpha = \min \left( 1, \frac{p(\theta') q(\theta^{(t)} | \theta')}{p(\theta^{(t)}) q(\theta' | \theta^{(t)})} \right)
   \]

   其中，\( p(\theta) \) 是目標後驗分布，\( q(\theta'|\theta) \) 是提議分布。

3. 以概率 \( \alpha \) 接受候選點 \( \theta' \)，否則保持當前狀態 \( \theta^{(t)} \)。
4. 重複這個過程，直到收集到足夠多的樣本。

Metropolis-Hastings 算法的關鍵在於其提議分布 \( q(\theta' | \theta) \) 的選擇。理想情況下，這個分布應該能夠有效探索參數空間，從而加速收斂。

##### 11.4.2.2 Gibbs 采樣

Gibbs 采樣是一種特殊的 MCMC 方法，適用於多元分布的情況。與 Metropolis-Hastings 不同，Gibbs 采樣不需要計算接受概率，而是逐步更新每一個變數的條件分布。具體步驟如下：

1. 假設有多個變數 \( \theta = (\theta_1, \theta_2, \dots, \theta_k) \)。
2. 從條件分布 \( p(\theta_1 | \theta_2, \dots, \theta_k) \) 中抽樣得到新的 \( \theta_1' \)。
3. 根據新的 \( \theta_1' \)，從條件分布 \( p(\theta_2 | \theta_1', \dots, \theta_k) \) 中抽樣得到新的 \( \theta_2' \)。
4. 重複這一過程，直到所有變數都更新完畢。

Gibbs 采樣的優勢在於它不需要額外的接受步驟，並且適用於條件分布容易計算的情況。當每個條件分布可以輕易地抽樣時，Gibbs 采樣是一個非常高效的方法。

#### 11.4.3 MCMC 的收斂性

MCMC 的一個重要問題是收斂性，即馬可夫鏈是否能夠穩定地達到目標分布。通常，MCMC 的收斂性會受到以下因素的影響：

- **初始值的選擇**：如果初始值離目標分布較遠，則可能需要更多的步驟才能達到穩定的後驗分布。
- **提議分布的選擇**：提議分布的設計應該能夠有效探索參數空間。如果提議分布過於狹窄或過於寬泛，都可能導致收斂速度過慢。
- **鏈的長度**：為了保證樣本的代表性，MCMC 算法需要進行足夠長時間的迭代，即所謂的“燒入”期，並且在收集樣本前應該進行充分的步驟。

#### 11.4.4 MCMC 的應用

MCMC 在貝葉斯推論中有著廣泛的應用，特別是對於高維、複雜的問題，MCMC 是解決後驗分布抽樣的首選方法。以下是一些常見的應用領域：

- **貝葉斯回歸**：利用 MCMC 進行回歸分析中的後驗分布抽樣，進而進行預測與推斷。
- **貝葉斯網絡**：對於包含多個隨機變數和複雜依賴關係的問題，MCMC 可以有效地從後驗分布中抽樣，進行推斷與預測。
- **統計物理學**：MCMC 方法在統計物理學中被廣泛應用，尤其是模擬粒子系統和隨機過程。
- **生物統計與流行病學**：在複雜的生物統計模型和流行病學研究中，MCMC 是進行參數估計和模型選擇的常用工具。

#### 11.4.5 小結

MCMC 是貝葉斯推論中不可或缺的工具，通過馬可夫鏈的隨機過程，能夠有效地從高維、複雜的後驗分布中進行抽樣。Metropolis-Hastings 和 Gibbs 采樣是最常見的 MCMC 算法，它們在實際應用中具有強大的靈活性和廣泛的應用領域。儘管 MCMC 算法存在收斂性問題，但通過合理設計和適當的技巧，MCMC 可以為各種統計推斷問題提供強有力的支持。