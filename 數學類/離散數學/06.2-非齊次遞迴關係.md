### 6.2 非齊次遞迴關係（Non-homogeneous Recurrence Relations）

非齊次遞迴關係是包含了外部強迫項（即非零的右側函數）的一類遞迴關係。與齊次遞迴關係不同，非齊次遞迴關係的解法需要同時處理齊次解和特解。這一過程通常分為兩個階段：首先解齊次部分，然後對非齊次部分進行特解假設，並綜合這些解。

#### 6.2.1 非齊次遞迴關係的一般形式

一個非齊次遞迴關係的一般形式為：


```math
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k} + f(n)

```

其中：
-  $a_n$  是數列的第  $n$  項，
-  $c_1, c_2, \dots, c_k$  是常數係數，
-  $f(n)$  是已知的外部強迫項函數，通常這是非零的，與  $a_n$  的遞迴運算無關。

#### 6.2.2 解法步驟

解非齊次遞迴關係的步驟通常包括以下幾個：

1. **解齊次部分**：
   首先，考慮不包含外部強迫項的齊次遞迴關係：

```math
   a_n^{(h)} = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k}

```
   解這一齊次部分，得到其通解  $a_n^{(h)}$ 。

2. **猜測特解**：
   對於非齊次項  $f(n)$ ，我們需要根據  $f(n)$  的形式猜測一個特解  $a_n^{(p)}$ 。特解的猜測形式通常依賴於  $f(n)$  的種類：
   - 若  $f(n)$  是常數，則猜測  $a_n^{(p)}$  為常數。
   - 若  $f(n)$  是多項式，則猜測特解是相應度數的多項式。
   - 若  $f(n)$  是指數函數或包含指數函數，則猜測特解是指數形式。
   - 若  $f(n)$  是與齊次解相似的函數，則需要乘上一些額外的因子（例如  $n$  或  $n^2$  等）。

3. **代入並求解特解**：
   將猜測的特解  $a_n^{(p)}$  代入遞迴關係中，並確定其未知常數。這樣可以求得特解。

4. **綜合解**：
   最終的解是齊次解和特解的總和，即：

```math
   a_n = a_n^{(h)} + a_n^{(p)}

```
   其中  $a_n^{(h)}$  是齊次解， $a_n^{(p)}$  是特解。

5. **使用初始條件確定常數**：
   通過給定的初始條件來確定常數  $A_1, A_2, \dots, A_k$  以及特解中的未知常數。

#### 6.2.3 例子

考慮以下非齊次遞迴關係：


```math
a_n = 3a_{n-1} - 4a_{n-2} + 5, \quad a_0 = 2, \quad a_1 = 4

```

**步驟 1：解齊次部分**

首先考慮齊次遞迴關係：


```math
a_n^{(h)} = 3a_{n-1} - 4a_{n-2}

```

其特徵方程為：


```math
r^2 - 3r + 4 = 0

```

解特徵方程得到根  $r_1 = 1 + i$  和  $r_2 = 1 - i$ ，所以齊次解為：


```math
a_n^{(h)} = A_1 (1 + i)^n + A_2 (1 - i)^n

```

**步驟 2：猜測特解**

由於右側的強迫項是常數 5，根據常見的遞迴關係解法，我們猜測特解的形式為常數  $a_n^{(p)} = B$ 。

將這個特解代入非齊次遞迴關係：


```math
B = 3B - 4B + 5

```

解得  $B = \frac{5}{2}$ 。

**步驟 3：總解**

因此，非齊次遞迴關係的總解為：


```math
a_n = a_n^{(h)} + a_n^{(p)} = A_1 (1 + i)^n + A_2 (1 - i)^n + \frac{5}{2}

```

**步驟 4：使用初始條件確定常數**

使用初始條件  $a_0 = 2$  和  $a_1 = 4$  來確定常數  $A_1$  和  $A_2$ 。這些常數可以通過代入  $n = 0$  和  $n = 1$  解得。

#### 6.2.4 特別情況：強迫項與齊次解相同

如果強迫項  $f(n)$  與齊次解的某個部分相同（例如，強迫項是指數函數，且齊次解中也有指數項），那麼我們必須對特解進行修正。常見的修正方法是將特解乘以  $n$  的適當次方。例如，如果強迫項與齊次解中的某個指數項相同，我們可以猜測特解的形式為  $a_n^{(p)} = B n r^n$ ，其中  $r$  是特徵方程的根。

#### 6.2.5 結論

非齊次遞迴關係的解法是處理數列遞迴中的一個重要技術。它要求我們首先解齊次部分，然後根據強迫項的形式來猜測並解特解。這一過程有助於在各種應用中求解複雜的遞迴關係，並廣泛應用於數學、計算機科學以及工程領域。