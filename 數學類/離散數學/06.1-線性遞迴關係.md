### 6.1 線性遞迴關係（Linear Recurrence Relations）

線性遞迴關係描述了數列中每一項與其前幾項之間的線性關係。這種類型的遞迴關係在數學、計算機科學和工程中非常常見。解決這類遞迴關係的目的是找到數列的封閉形式（closed form），即不依賴於遞迴關係的明確表示式。

#### 6.1.1 線性遞迴關係的定義

一個一般的線性遞迴關係可以表示為：

\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k} + f(n)
\]

其中：
- \( a_n \) 是數列的第 \( n \) 項，
- \( c_1, c_2, \dots, c_k \) 是常數係數，
- \( f(n) \) 是一個已知的函數（若 \( f(n) = 0 \)，則該遞迴關係為齊次遞迴關係）。

這種遞迴關係的解法通常分為兩種情況：
1. **齊次遞迴關係**：即 \( f(n) = 0 \)，沒有外部強迫項。
2. **非齊次遞迴關係**：即 \( f(n) \neq 0 \)，有外部強迫項。

#### 6.1.2 齊次線性遞迴關係

對於齊次線性遞迴關係，形式為：

\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k}
\]

其解法步驟如下：

1. **寫出特徵方程式**：
   假設解的形式為 \( a_n = r^n \)，代入遞迴關係得到：
   \[
   r^n = c_1 r^{n-1} + c_2 r^{n-2} + \cdots + c_k r^{n-k}
   \]
   簡化後得到特徵方程式：
   \[
   r^k - c_1 r^{k-1} - c_2 r^{k-2} - \cdots - c_k = 0
   \]
   這是一個 \( k \) 次的代數方程式，稱為**特徵方程**。

2. **解特徵方程**：
   解這個特徵方程，得到 \( k \) 個根 \( r_1, r_2, \dots, r_k \)。根的類型會影響解的形式：
   - **若所有根都不同**，則通解為：
     \[
     a_n = A_1 r_1^n + A_2 r_2^n + \cdots + A_k r_k^n
     \]
   - **若有重根**，例如 \( r_1 = r_2 = \dots = r_m \)，則通解為：
     \[
     a_n = (A_1 + A_2 n + A_3 n^2 + \cdots + A_m n^{m-1}) r_1^n
     \]

3. **使用初始條件確定常數**：
   通過已知的初始條件（例如 \( a_0, a_1, \dots, a_{k-1} \)），我們可以求出常數 \( A_1, A_2, \dots, A_k \)。

#### 6.1.3 非齊次線性遞迴關係

對於非齊次線性遞迴關係，形式為：

\[
a_n = c_1 a_{n-1} + c_2 a_{n-2} + \cdots + c_k a_{n-k} + f(n)
\]

解這類遞迴關係的方法分為兩個步驟：

1. **解齊次部分**：
   首先，解對應的齊次遞迴關係，即忽略 \( f(n) \)，得到齊次解 \( a_n^{(h)} \)，其形式如下：
   \[
   a_n^{(h)} = A_1 r_1^n + A_2 r_2^n + \cdots + A_k r_k^n
   \]

2. **解非齊次部分**：
   接下來，對於非齊次項 \( f(n) \)，我們猜測一個特解 \( a_n^{(p)} \)。根據 \( f(n) \) 的形式，可以選擇適當的假設。例如，若 \( f(n) \) 是常數、線性、指數或多項式等，可以對應地選擇特解的形式。
   - 若 \( f(n) \) 是常數，則特解可能是常數。
   - 若 \( f(n) \) 是線性多項式，則特解也可以是假設為線性多項式。
   - 若 \( f(n) \) 是指數函數，則特解可能是指數函數形式。

3. **綜合解**：
   最後，數列的總解為齊次解和特解的和：
   \[
   a_n = a_n^{(h)} + a_n^{(p)}
   \]

4. **使用初始條件確定常數**：
   使用初始條件來確定解中的常數 \( A_1, A_2, \dots, A_k \) 及特解的參數。

#### 6.1.4 例子：解線性遞迴關係

考慮遞迴關係：
\[
a_n = 3a_{n-1} - 4a_{n-2}, \quad a_0 = 2, \quad a_1 = 5
\]

1. **解齊次部分**：
   寫出特徵方程：
   \[
   r^2 - 3r + 4 = 0
   \]
   解得兩個根 \( r_1 = 1 + i \), \( r_2 = 1 - i \)，這是兩個複數根。

   因此，齊次解為：
   \[
   a_n^{(h)} = A_1 (1 + i)^n + A_2 (1 - i)^n
   \]

2. **使用初始條件確定常數**：
   使用初始條件 \( a_0 = 2 \) 和 \( a_1 = 5 \)，可以解出常數 \( A_1 \) 和 \( A_2 \)。

3. **得到最終解**：
   數列的最終解為：
   \[
   a_n = a_n^{(h)}
   \]
   並且通過初始條件可以確定常數 \( A_1 \) 和 \( A_2 \)。

#### 6.1.5 結論

線性遞迴關係在許多數學和工程領域中都有廣泛應用，解這類遞迴關係的技巧也非常重要。通過解特徵方程、使用齊次解和特解，並結合初始條件，我們可以得到數列的封閉式解。